"use strict";(globalThis.webpackChunkphysical_ai_book_humanoid=globalThis.webpackChunkphysical_ai_book_humanoid||[]).push([[5968],{7787(n,e,i){i.r(e),i.d(e,{assets:()=>r,contentTitle:()=>l,default:()=>d,frontMatter:()=>s,metadata:()=>a,toc:()=>m});const a=JSON.parse('{"id":"module-2-digital-twin/chapter-3-environment-modeling","title":"Environment Modeling for Digital Twins","description":"Creating realistic environments for simulation and testing in digital twins","source":"@site/docs/module-2-digital-twin/chapter-3-environment-modeling.md","sourceDirName":"module-2-digital-twin","slug":"/module-2-digital-twin/chapter-3-environment-modeling","permalink":"/textbook/docs/module-2-digital-twin/chapter-3-environment-modeling","draft":false,"unlisted":false,"editUrl":"https://github.com/Panaversity/physical_ai_book_humanoid/tree/main/docs/module-2-digital-twin/chapter-3-environment-modeling.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"title":"Environment Modeling for Digital Twins","sidebar_position":4,"description":"Creating realistic environments for simulation and testing in digital twins","keywords":["environment modeling","gazebo worlds","unity environments","robotics simulation"]},"sidebar":"tutorialSidebar","previous":{"title":"Sensor Simulation in Gazebo","permalink":"/textbook/docs/module-2-digital-twin/chapter-2-sensor-simulation"},"next":{"title":"Unity Visualization for Human-Robot Interaction","permalink":"/textbook/docs/module-2-digital-twin/chapter-4-unity-visualization"}}');var t=i(4848),o=i(8453);const s={title:"Environment Modeling for Digital Twins",sidebar_position:4,description:"Creating realistic environments for simulation and testing in digital twins",keywords:["environment modeling","gazebo worlds","unity environments","robotics simulation"]},l="Chapter 3: Environment Modeling for Digital Twins",r={},m=[{value:"Learning Objectives",id:"learning-objectives",level:2},{value:"Prerequisites",id:"prerequisites",level:2},{value:"Core Concepts",id:"core-concepts",level:2},{value:"Key Components of Environment Modeling",id:"key-components-of-environment-modeling",level:3},{value:"SDF World File Structure",id:"sdf-world-file-structure",level:3},{value:"Implementation",id:"implementation",level:2},{value:"Basic Indoor Environment",id:"basic-indoor-environment",level:3},{value:"Advanced Environment with Multiple Rooms",id:"advanced-environment-with-multiple-rooms",level:3},{value:"Examples",id:"examples",level:2},{value:"Example 1: Environment Validation Node",id:"example-1-environment-validation-node",level:3},{value:"Example 2: Environment Change Monitor",id:"example-2-environment-change-monitor",level:3},{value:"Summary",id:"summary",level:2},{value:"Exercises",id:"exercises",level:2},{value:"Conceptual",id:"conceptual",level:3},{value:"Logical",id:"logical",level:3},{value:"Implementation",id:"implementation-1",level:3}];function c(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,o.R)(),...n.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(e.header,{children:(0,t.jsx)(e.h1,{id:"chapter-3-environment-modeling-for-digital-twins",children:"Chapter 3: Environment Modeling for Digital Twins"})}),"\n",(0,t.jsx)(e.h2,{id:"learning-objectives",children:"Learning Objectives"}),"\n",(0,t.jsx)(e.p,{children:"By the end of this chapter, students will be able to:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Design and create realistic 3D environments for robotics simulation"}),"\n",(0,t.jsx)(e.li,{children:"Implement complex world files with varied terrains, obstacles, and interactive elements"}),"\n",(0,t.jsx)(e.li,{children:"Configure lighting, weather, and environmental conditions in simulation"}),"\n",(0,t.jsx)(e.li,{children:"Integrate environmental sensors with physics properties for realistic interaction"}),"\n",(0,t.jsx)(e.li,{children:"Validate environment models against real-world scenarios"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,t.jsx)(e.p,{children:"Students should have:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Understanding of 3D coordinate systems and transformations"}),"\n",(0,t.jsx)(e.li,{children:"Basic knowledge of physics simulation (covered in Chapter 1)"}),"\n",(0,t.jsx)(e.li,{children:"Experience with sensor simulation (covered in Chapter 2)"}),"\n",(0,t.jsx)(e.li,{children:"Familiarity with XML/SDF format for Gazebo world files"}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,t.jsx)(e.p,{children:"Environment modeling is fundamental to digital twin technology, as it creates the virtual space where robots operate. A well-designed environment enables comprehensive testing of robot capabilities under various conditions."}),"\n",(0,t.jsx)(e.h3,{id:"key-components-of-environment-modeling",children:"Key Components of Environment Modeling"}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Terrain and Ground Surfaces:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Flat surfaces for basic navigation"}),"\n",(0,t.jsx)(e.li,{children:"Complex terrain with elevation changes"}),"\n",(0,t.jsx)(e.li,{children:"Varied friction coefficients for different surfaces"}),"\n",(0,t.jsx)(e.li,{children:"Dynamic surfaces that can change during simulation"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Static Obstacles:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Walls, furniture, and architectural elements"}),"\n",(0,t.jsx)(e.li,{children:"Proper collision properties for realistic interaction"}),"\n",(0,t.jsx)(e.li,{children:"Visual appearance that matches the intended application"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Dynamic Elements:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Moving obstacles that simulate people or vehicles"}),"\n",(0,t.jsx)(e.li,{children:"Interactive objects that robots can manipulate"}),"\n",(0,t.jsx)(e.li,{children:"Environmental changes (doors opening/closing, lights changing)"}),"\n"]}),"\n",(0,t.jsx)(e.p,{children:(0,t.jsx)(e.strong,{children:"Environmental Conditions:"})}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsx)(e.li,{children:"Lighting variations (day/night, indoor/outdoor)"}),"\n",(0,t.jsx)(e.li,{children:"Weather effects (rain, fog, wind)"}),"\n",(0,t.jsx)(e.li,{children:"Acoustic properties for sound-based sensors"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"sdf-world-file-structure",children:"SDF World File Structure"}),"\n",(0,t.jsx)(e.p,{children:"The Simulation Description Format (SDF) is used to define Gazebo environments:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="humanoid_environment">\n    \x3c!-- World properties --\x3e\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n    </physics>\n\n    \x3c!-- Lighting --\x3e\n    <light name="sun" type="directional">\n      <cast_shadows>true</cast_shadows>\n      <pose>0 0 10 0 0 0</pose>\n      <diffuse>0.8 0.8 0.8 1</diffuse>\n      <specular>0.2 0.2 0.2 1</specular>\n      <attenuation>\n        <range>1000</range>\n        <constant>0.9</constant>\n        <linear>0.01</linear>\n        <quadratic>0.001</quadratic>\n      </attenuation>\n      <direction>-0.3 0.1 -0.9</direction>\n    </light>\n\n    \x3c!-- Ground plane --\x3e\n    <model name="ground_plane">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <surface>\n            <friction>\n              <ode>\n                <mu>1.0</mu>\n                <mu2>1.0</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <material>\n            <ambient>0.7 0.7 0.7 1</ambient>\n            <diffuse>0.7 0.7 0.7 1</diffuse>\n            <specular>0.0 0.0 0.0 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Environment objects --\x3e\n    <include>\n      <uri>model://humanoid_robot</uri>\n      <pose>0 0 1.0 0 0 0</pose>\n    </include>\n  </world>\n</sdf>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"implementation",children:"Implementation"}),"\n",(0,t.jsx)(e.p,{children:"Let's implement a comprehensive environment model for our humanoid robot. We'll create a multi-room environment with various challenges and interactive elements."}),"\n",(0,t.jsx)(e.h3,{id:"basic-indoor-environment",children:"Basic Indoor Environment"}),"\n",(0,t.jsx)(e.p,{children:"First, let's create a basic indoor environment:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="indoor_hallway">\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n    </physics>\n\n    \x3c!-- Sun light --\x3e\n    <light name="sun" type="directional">\n      <cast_shadows>true</cast_shadows>\n      <pose>0 0 10 0 0 0</pose>\n      <diffuse>0.8 0.8 0.8 1</diffuse>\n      <specular>0.2 0.2 0.2 1</specular>\n      <direction>-0.3 0.1 -0.9</direction>\n    </light>\n\n    \x3c!-- Ground plane --\x3e\n    <model name="ground_plane">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n            </plane>\n          </geometry>\n          <surface>\n            <friction>\n              <ode>\n                <mu>0.6</mu>\n                <mu2>0.6</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>10 10</size>\n            </plane>\n          </geometry>\n          <material>\n            <ambient>0.7 0.7 0.7 1</ambient>\n            <diffuse>0.7 0.7 0.7 1</diffuse>\n            <specular>0.0 0.0 0.0 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Walls --\x3e\n    <model name="wall_front">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>10 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>10 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.8 0.8 1</ambient>\n            <diffuse>0.8 0.8 0.8 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 -2.5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="wall_back">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>10 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>10 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.8 0.8 1</ambient>\n            <diffuse>0.8 0.8 0.8 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 2.5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="wall_left">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.8 0.8 1</ambient>\n            <diffuse>0.8 0.8 0.8 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>-5 0 1.25 0 0 0</pose>\n    </model>\n\n    <model name="wall_right">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.8 0.8 0.8 1</ambient>\n            <diffuse>0.8 0.8 0.8 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>5 0 1.25 0 0 0</pose>\n    </model>\n\n    \x3c!-- Obstacles --\x3e\n    <model name="obstacle1">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <cylinder>\n              <radius>0.3</radius>\n              <length>1.0</length>\n            </cylinder>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <cylinder>\n              <radius>0.3</radius>\n              <length>1.0</length>\n            </cylinder>\n          </geometry>\n          <material>\n            <ambient>0.9 0.2 0.2 1</ambient>\n            <diffuse>0.9 0.2 0.2 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>-2 0 0.5 0 0 0</pose>\n    </model>\n\n    <model name="obstacle2">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.5 0.5 0.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.5 0.5 0.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.2 0.2 0.9 1</ambient>\n            <diffuse>0.2 0.2 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>2 1 0.25 0 0 0</pose>\n    </model>\n\n    \x3c!-- Spawn point for robot --\x3e\n    <include>\n      <uri>model://humanoid_robot</uri>\n      <pose>0 0 1.0 0 0 0</pose>\n    </include>\n  </world>\n</sdf>\n'})}),"\n",(0,t.jsx)(e.h3,{id:"advanced-environment-with-multiple-rooms",children:"Advanced Environment with Multiple Rooms"}),"\n",(0,t.jsx)(e.p,{children:"For more complex scenarios, we can create interconnected rooms:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-xml",children:'<?xml version="1.0" ?>\n<sdf version="1.7">\n  <world name="multi_room_house">\n    <physics type="ode">\n      <max_step_size>0.001</max_step_size>\n      <real_time_factor>1.0</real_time_factor>\n      <real_time_update_rate>1000</real_time_update_rate>\n      <gravity>0 0 -9.8</gravity>\n    </physics>\n\n    \x3c!-- Environment properties --\x3e\n    <scene>\n      <ambient>0.3 0.3 0.3 1</ambient>\n      <background>0.6 0.7 0.8 1</background>\n      <shadows>true</shadows>\n    </scene>\n\n    \x3c!-- Lighting --\x3e\n    <light name="sun" type="directional">\n      <cast_shadows>true</cast_shadows>\n      <pose>0 0 10 0 0 0</pose>\n      <diffuse>0.8 0.8 0.7 1</diffuse>\n      <specular>0.2 0.2 0.2 1</specular>\n      <direction>-0.3 0.1 -0.9</direction>\n    </light>\n\n    \x3c!-- Indoor lighting --\x3e\n    <light name="room_light1" type="point">\n      <pose>-2 0 2 0 0 0</pose>\n      <diffuse>0.9 0.9 0.8 1</diffuse>\n      <specular>0.1 0.1 0.1 1</specular>\n      <attenuation>\n        <range>10</range>\n        <constant>0.5</constant>\n        <linear>0.1</linear>\n        <quadratic>0.01</quadratic>\n      </attenuation>\n    </light>\n\n    <light name="room_light2" type="point">\n      <pose>2 0 2 0 0 0</pose>\n      <diffuse>0.9 0.9 0.8 1</diffuse>\n      <specular>0.1 0.1 0.1 1</specular>\n      <attenuation>\n        <range>10</range>\n        <constant>0.5</constant>\n        <linear>0.1</linear>\n        <quadratic>0.01</quadratic>\n      </attenuation>\n    </light>\n\n    \x3c!-- Ground plane --\x3e\n    <model name="floor">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n            </plane>\n          </geometry>\n          <surface>\n            <friction>\n              <ode>\n                <mu>0.8</mu>\n                <mu2>0.8</mu2>\n              </ode>\n            </friction>\n          </surface>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <plane>\n              <normal>0 0 1</normal>\n              <size>20 10</size>\n            </plane>\n          </geometry>\n          <material>\n            <ambient>0.7 0.7 0.7 1</ambient>\n            <diffuse>0.8 0.7 0.6 1</diffuse>\n            <specular>0.1 0.1 0.1 1</specular>\n          </material>\n        </visual>\n      </link>\n    </model>\n\n    \x3c!-- Room walls --\x3e\n    \x3c!-- Living room walls --\x3e\n    <model name="living_wall_front">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 -5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="living_wall_back">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 0 1.25 0 0 0</pose>\n    </model>\n\n    <model name="living_wall_left">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>-4 -2.5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="living_wall_right">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>4 -2.5 1.25 0 0 0</pose>\n    </model>\n\n    \x3c!-- Kitchen walls --\x3e\n    <model name="kitchen_wall_front">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="kitchen_wall_back">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>8 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 0 1.25 0 0 0</pose>\n    </model>\n\n    <model name="kitchen_wall_left">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>-4 2.5 1.25 0 0 0</pose>\n    </model>\n\n    <model name="kitchen_wall_right">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.2 5 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.9 0.9 0.9 1</ambient>\n            <diffuse>0.9 0.9 0.9 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>4 2.5 1.25 0 0 0</pose>\n    </model>\n\n    \x3c!-- Doorway between rooms --\x3e\n    <model name="doorway">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1.5 0.2 2.5</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1.5 0.2 2.5</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.5 0.3 0.2 1</ambient>\n            <diffuse>0.5 0.3 0.2 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>0 0 1.25 0 0 0</pose>\n    </model>\n\n    \x3c!-- Furniture --\x3e\n    <model name="table">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>1.2 0.6 0.8</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>1.2 0.6 0.8</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.6 0.4 0.2 1</ambient>\n            <diffuse>0.6 0.4 0.2 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>2 -3 0.4 0 0 0</pose>\n    </model>\n\n    <model name="chair">\n      <static>true</static>\n      <link name="link">\n        <collision name="collision">\n          <geometry>\n            <box>\n              <size>0.4 0.4 0.8</size>\n            </box>\n          </geometry>\n        </collision>\n        <visual name="visual">\n          <geometry>\n            <box>\n              <size>0.4 0.4 0.8</size>\n            </box>\n          </geometry>\n          <material>\n            <ambient>0.4 0.2 0.6 1</ambient>\n            <diffuse>0.4 0.2 0.6 1</diffuse>\n          </material>\n        </visual>\n      </link>\n      <pose>2.5 -3.5 0.4 0 0 0</pose>\n    </model>\n\n    \x3c!-- Spawn point for robot --\x3e\n    <include>\n      <uri>model://humanoid_robot</uri>\n      <pose>0 -3 1.0 0 0 0</pose>\n    </include>\n  </world>\n</sdf>\n'})}),"\n",(0,t.jsx)(e.h2,{id:"examples",children:"Examples"}),"\n",(0,t.jsx)(e.h3,{id:"example-1-environment-validation-node",children:"Example 1: Environment Validation Node"}),"\n",(0,t.jsx)(e.p,{children:"Let's create a node to validate environment properties and test robot navigation:"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:'#!/usr/bin/env python3\n# environment_validator.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import LaserScan\nfrom geometry_msgs.msg import Twist, PoseStamped\nfrom nav_msgs.msg import Odometry\nfrom tf2_ros import TransformListener, Buffer\nimport numpy as np\nimport math\n\nclass EnvironmentValidator(Node):\n    """Validate environment properties and test robot navigation"""\n\n    def __init__(self):\n        super().__init__(\'environment_validator\')\n\n        # Subscribers\n        self.scan_sub = self.create_subscription(\n            LaserScan,\n            \'/humanoid/scan\',\n            self.scan_callback,\n            10\n        )\n\n        self.odom_sub = self.create_subscription(\n            Odometry,\n            \'/humanoid/odom\',\n            self.odom_callback,\n            10\n        )\n\n        # Publisher for navigation commands\n        self.cmd_vel_pub = self.create_publisher(Twist, \'/humanoid/cmd_vel\', 10)\n\n        # TF listener\n        self.tf_buffer = Buffer()\n        self.tf_listener = TransformListener(self.tf_buffer, self)\n\n        # Navigation state\n        self.current_pose = None\n        self.navigation_targets = [\n            (-2.0, -3.0, 0.0),  # Living room target\n            (2.0, 3.0, 0.0),    # Kitchen target\n            (0.0, 0.0, 0.0)     # Center of hallway\n        ]\n        self.current_target_idx = 0\n        self.target_tolerance = 0.5\n\n        # Timers\n        self.nav_timer = self.create_timer(0.1, self.navigate_to_target)\n        self.status_timer = self.create_timer(5.0, self.report_environment_status)\n\n        # Statistics\n        self.stats = {\n            \'distance_traveled\': 0.0,\n            \'collisions_detected\': 0,\n            \'obstacles_avoided\': 0,\n            \'navigation_success\': 0\n        }\n\n    def scan_callback(self, msg):\n        """Process laser scan data to detect obstacles"""\n        # Check for obstacles in front of robot\n        front_scan_idx = len(msg.ranges) // 2\n        front_range = msg.ranges[front_scan_idx]\n\n        if front_range < 0.8:  # Obstacle within 80cm\n            self.get_logger().warn(f\'Obstacle detected in front: {front_range:.2f}m\')\n            self.stats[\'obstacles_avoided\'] += 1\n\n            # Trigger avoidance maneuver\n            self.execute_avoidance_maneuver()\n\n    def odom_callback(self, msg):\n        """Update current robot pose"""\n        self.current_pose = msg.pose.pose\n\n    def navigate_to_target(self):\n        """Navigate towards current target"""\n        if not self.current_pose:\n            return\n\n        # Get current position\n        current_x = self.current_pose.position.x\n        current_y = self.current_pose.position.y\n\n        # Get current target\n        target = self.navigation_targets[self.current_target_idx]\n        target_x, target_y, target_z = target\n\n        # Calculate distance to target\n        dist_to_target = math.sqrt((target_x - current_x)**2 + (target_y - current_y)**2)\n\n        if dist_to_target < self.target_tolerance:\n            self.get_logger().info(f\'Reached target {self.current_target_idx}: ({target_x}, {target_y})\')\n            self.stats[\'navigation_success\'] += 1\n            self.current_target_idx = (self.current_target_idx + 1) % len(self.navigation_targets)\n            return\n\n        # Calculate desired velocity\n        cmd_vel = Twist()\n\n        # Proportional controller for navigation\n        k_linear = 0.5\n        k_angular = 1.0\n\n        # Linear velocity proportional to distance\n        cmd_vel.linear.x = min(k_linear * dist_to_target, 0.5)\n\n        # Calculate angle to target\n        angle_to_target = math.atan2(target_y - current_y, target_x - current_x)\n\n        # Current orientation (simplified - assuming z-axis rotation)\n        current_yaw = 2 * math.asin(self.current_pose.orientation.z)\n\n        # Angular error\n        angle_error = angle_to_target - current_yaw\n        # Normalize angle to [-pi, pi]\n        while angle_error > math.pi:\n            angle_error -= 2 * math.pi\n        while angle_error < -math.pi:\n            angle_error += 2 * math.pi\n\n        cmd_vel.angular.z = k_angular * angle_error\n\n        # Publish command\n        self.cmd_vel_pub.publish(cmd_vel)\n\n    def execute_avoidance_maneuver(self):\n        """Execute obstacle avoidance maneuver"""\n        cmd_vel = Twist()\n        cmd_vel.linear.x = 0.0  # Stop forward motion\n        cmd_vel.angular.z = 0.5  # Turn slightly\n        self.cmd_vel_pub.publish(cmd_vel)\n\n        # After short delay, resume navigation\n        self.get_logger().info(\'Executing obstacle avoidance maneuver\')\n\n    def report_environment_status(self):\n        """Report environment validation statistics"""\n        self.get_logger().info(\'=== Environment Validation Report ===\')\n        self.get_logger().info(f\'Distance traveled: {self.stats["distance_traveled"]:.2f}m\')\n        self.get_logger().info(f\'Collisions detected: {self.stats["collisions_detected"]}\')\n        self.get_logger().info(f\'Obstacles avoided: {self.stats["obstacles_avoided"]}\')\n        self.get_logger().info(f\'Navigation successes: {self.stats["navigation_success"]}\')\n        self.get_logger().info(\'=====================================\')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    validator = EnvironmentValidator()\n\n    try:\n        rclpy.spin(validator)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        validator.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == \'__main__\':\n    main()\n'})}),"\n",(0,t.jsx)(e.h3,{id:"example-2-environment-change-monitor",children:"Example 2: Environment Change Monitor"}),"\n",(0,t.jsx)(e.pre,{children:(0,t.jsx)(e.code,{className:"language-python",children:"#!/usr/bin/env python3\n# environment_monitor.py\n\nimport rclpy\nfrom rclpy.node import Node\nfrom sensor_msgs.msg import LaserScan, Image\nfrom geometry_msgs.msg import PointStamped\nfrom visualization_msgs.msg import MarkerArray, Marker\nfrom std_msgs.msg import ColorRGBA\nimport numpy as np\nimport cv2\nfrom cv_bridge import CvBridge\n\nclass EnvironmentMonitor(Node):\n    \"\"\"Monitor environmental changes and detect anomalies\"\"\"\n\n    def __init__(self):\n        super().__init__('environment_monitor')\n\n        # Subscribers\n        self.scan_sub = self.create_subscription(\n            LaserScan,\n            '/humanoid/scan',\n            self.scan_callback,\n            10\n        )\n\n        self.image_sub = self.create_subscription(\n            Image,\n            '/humanoid/camera/image_raw',\n            self.image_callback,\n            10\n        )\n\n        # Publishers\n        self.anomaly_pub = self.create_publisher(PointStamped, '/humanoid/environment/anomalies', 10)\n        self.viz_pub = self.create_publisher(MarkerArray, '/humanoid/environment/visualization', 10)\n\n        # CV Bridge\n        self.cv_bridge = CvBridge()\n\n        # Environment baseline (will be established over time)\n        self.baseline_scans = []\n        self.baseline_images = []\n        self.max_baseline_samples = 10\n\n        # Anomaly detection parameters\n        self.anomaly_threshold = 0.2  # Threshold for detecting environmental changes\n        self.environment_map = {}     # Store known environment features\n\n        # Timers\n        self.update_timer = self.create_timer(1.0, self.update_environment_model)\n\n    def scan_callback(self, msg):\n        \"\"\"Process laser scan and detect environmental changes\"\"\"\n        # Store scan for baseline calculation\n        if len(self.baseline_scans) < self.max_baseline_samples:\n            self.baseline_scans.append(list(msg.ranges))\n            self.get_logger().info(f'Collecting baseline scan {len(self.baseline_scans)}/{self.max_baseline_samples}')\n            return\n\n        # Calculate average baseline\n        avg_baseline = np.mean(self.baseline_scans, axis=0)\n\n        # Compare current scan with baseline\n        current_scan = np.array(msg.ranges)\n\n        # Mask invalid ranges\n        valid_mask = ~(np.isnan(current_scan) | np.isinf(current_scan))\n        baseline_valid = avg_baseline[valid_mask]\n        current_valid = current_scan[valid_mask]\n\n        if len(baseline_valid) > 0:\n            # Calculate difference\n            diff = np.abs(baseline_valid - current_valid)\n            max_diff = np.max(diff)\n\n            if max_diff > self.anomaly_threshold:\n                self.get_logger().warn(f'ENVIRONMENT CHANGE DETECTED: max diff = {max_diff:.2f}m')\n\n                # Find the index of maximum difference\n                max_idx = np.argmax(diff)\n\n                # Calculate the angle for that range measurement\n                angle_increment = (msg.angle_max - msg.angle_min) / len(msg.ranges)\n                angle = msg.angle_min + max_idx * angle_increment\n\n                # Convert to Cartesian coordinates relative to robot\n                range_val = current_valid[max_idx]\n                x = range_val * np.cos(angle)\n                y = range_val * np.sin(angle)\n\n                # Publish anomaly location\n                anomaly_point = PointStamped()\n                anomaly_point.header.stamp = self.get_clock().now().to_msg()\n                anomaly_point.header.frame_id = 'base_link'\n                anomaly_point.point.x = x\n                anomaly_point.point.y = y\n                anomaly_point.point.z = 0.0\n\n                self.anomaly_pub.publish(anomaly_point)\n\n                # Visualize the anomaly\n                self.visualize_anomaly(x, y)\n\n    def image_callback(self, msg):\n        \"\"\"Process camera image and detect visual changes\"\"\"\n        try:\n            cv_image = self.cv_bridge.imgmsg_to_cv2(msg, 'bgr8')\n\n            # Store image for baseline if needed\n            if len(self.baseline_images) < self.max_baseline_samples:\n                self.baseline_images.append(cv_image.copy())\n                return\n\n            # Compare with baseline images using optical flow\n            baseline_img = self.baseline_images[-1]  # Use most recent baseline\n\n            # Convert to grayscale\n            gray_current = cv2.cvtColor(cv_image, cv2.COLOR_BGR2GRAY)\n            gray_baseline = cv2.cvtColor(baseline_img, cv2.COLOR_BGR2GRAY)\n\n            # Calculate difference\n            diff_img = cv2.absdiff(gray_current, gray_baseline)\n\n            # Calculate average difference\n            avg_diff = np.mean(diff_img)\n\n            if avg_diff > 10:  # Threshold for significant visual change\n                self.get_logger().info(f'VISUAL CHANGE DETECTED: avg diff = {avg_diff:.2f}')\n\n        except Exception as e:\n            self.get_logger().error(f'Image processing error: {str(e)}')\n\n    def visualize_anomaly(self, x, y):\n        \"\"\"Visualize detected anomaly in RViz\"\"\"\n        marker_array = MarkerArray()\n\n        # Create a marker for the anomaly location\n        marker = Marker()\n        marker.header.stamp = self.get_clock().now().to_msg()\n        marker.header.frame_id = 'base_link'\n        marker.ns = 'environment_anomalies'\n        marker.id = 0\n        marker.type = Marker.SPHERE\n        marker.action = Marker.ADD\n\n        marker.pose.position.x = x\n        marker.pose.position.y = y\n        marker.pose.position.z = 0.5  # At robot eye level\n        marker.pose.orientation.w = 1.0\n\n        marker.scale.x = 0.2  # 20cm sphere\n        marker.scale.y = 0.2\n        marker.scale.z = 0.2\n\n        marker.color.r = 1.0  # Red color for anomaly\n        marker.color.g = 0.0\n        marker.color.b = 0.0\n        marker.color.a = 0.8  # Semi-transparent\n\n        marker.lifetime.sec = 5  # Visible for 5 seconds\n\n        marker_array.markers.append(marker)\n\n        # Publish the visualization\n        self.viz_pub.publish(marker_array)\n\n    def update_environment_model(self):\n        \"\"\"Update internal environment model\"\"\"\n        # This would typically update a map or other environment representation\n        # For this example, we'll just log the current state\n\n        if len(self.baseline_scans) >= self.max_baseline_samples:\n            avg_scan = np.mean(self.baseline_scans, axis=0)\n            self.get_logger().info(f'Environment model updated. Avg nearest obstacle: {np.min(avg_scan[np.isfinite(avg_scan)])}m')\n\ndef main(args=None):\n    rclpy.init(args=args)\n    monitor = EnvironmentMonitor()\n\n    try:\n        rclpy.spin(monitor)\n    except KeyboardInterrupt:\n        pass\n    finally:\n        monitor.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,t.jsx)(e.h2,{id:"summary",children:"Summary"}),"\n",(0,t.jsx)(e.p,{children:"Environment modeling is a critical aspect of digital twin technology for robotics. Well-designed environments enable comprehensive testing of robot capabilities under various conditions. Key considerations include:"}),"\n",(0,t.jsxs)(e.ul,{children:["\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Realistic Physics"}),": Ensuring proper friction, collision properties, and material characteristics"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Visual Fidelity"}),": Balancing visual realism with computational performance"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Interactive Elements"}),": Including objects and elements that robots can interact with"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Environmental Variations"}),": Modeling different lighting, weather, and acoustic conditions"]}),"\n",(0,t.jsxs)(e.li,{children:[(0,t.jsx)(e.strong,{children:"Scalability"}),": Designing environments that can be extended or modified as needed"]}),"\n"]}),"\n",(0,t.jsx)(e.h2,{id:"exercises",children:"Exercises"}),"\n",(0,t.jsx)(e.h3,{id:"conceptual",children:"Conceptual"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Explain the relationship between environment complexity and computational performance in robotics simulation."}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"logical",children:"Logical"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Analyze the trade-offs between environmental realism and simulation speed. When would you prioritize one over the other?"}),"\n"]}),"\n",(0,t.jsx)(e.h3,{id:"implementation-1",children:"Implementation"}),"\n",(0,t.jsxs)(e.ol,{children:["\n",(0,t.jsx)(e.li,{children:"Create a complex multi-room environment with varied terrain types, obstacles, and interactive elements, and implement an environment monitoring node that detects changes in the environment."}),"\n"]})]})}function d(n={}){const{wrapper:e}={...(0,o.R)(),...n.components};return e?(0,t.jsx)(e,{...n,children:(0,t.jsx)(c,{...n})}):c(n)}},8453(n,e,i){i.d(e,{R:()=>s,x:()=>l});var a=i(6540);const t={},o=a.createContext(t);function s(n){const e=a.useContext(o);return a.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function l(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(t):n.components||t:s(n.components),a.createElement(o.Provider,{value:e},n.children)}}}]);