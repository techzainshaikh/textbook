"use strict";(globalThis.webpackChunkphysical_ai_book_humanoid=globalThis.webpackChunkphysical_ai_book_humanoid||[]).push([[9191],{6780(e,n,t){t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>m,frontMatter:()=>r,metadata:()=>o,toc:()=>c});const o=JSON.parse('{"id":"examples/ros2-publisher","title":"ROS 2 Publisher Example","description":"Complete ROS 2 Publisher Node with WHAT/WHY Comments","source":"@site/docs/examples/ros2-publisher.md","sourceDirName":"examples","slug":"/examples/ros2-publisher","permalink":"/textbook/docs/examples/ros2-publisher","draft":false,"unlisted":false,"editUrl":"https://github.com/Panaversity/physical_ai_book_humanoid/tree/main/docs/examples/ros2-publisher.md","tags":[],"version":"current","frontMatter":{}}');var s=t(4848),i=t(8453);const r={},a="ROS 2 Publisher Example",l={},c=[{value:"Complete ROS 2 Publisher Node with WHAT/WHY Comments",id:"complete-ros-2-publisher-node-with-whatwhy-comments",level:2},{value:"Dependencies",id:"dependencies",level:2},{value:"How to Run",id:"how-to-run",level:2},{value:"Expected Output",id:"expected-output",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",header:"header",li:"li",p:"p",pre:"pre",ul:"ul",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"ros-2-publisher-example",children:"ROS 2 Publisher Example"})}),"\n",(0,s.jsx)(n.h2,{id:"complete-ros-2-publisher-node-with-whatwhy-comments",children:"Complete ROS 2 Publisher Node with WHAT/WHY Comments"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-python",children:"# Example: ROS 2 Publisher Node for Humanoid Robot Joint Commands\n# WHAT: This code creates a ROS 2 publisher node that publishes joint position commands\n# WHY: To demonstrate the basic publish-subscribe communication pattern in ROS 2, which is fundamental for humanoid robot control systems\n\nimport rclpy\nfrom rclpy.node import Node\nfrom std_msgs.msg import Float64MultiArray\nfrom sensor_msgs.msg import JointState\nimport math\nimport time\n\nclass JointCommandPublisher(Node):\n    def __init__(self):\n        super().__init__('joint_command_publisher')\n\n        # Create publisher for joint commands\n        # WHAT: This creates a publisher that sends joint position commands to the robot's controller\n        # WHY: The robot needs to receive desired joint positions to execute movements\n        self.publisher = self.create_publisher(Float64MultiArray, 'joint_commands', 10)\n\n        # Timer to periodically send commands\n        # WHAT: This timer callback executes every 0.1 seconds to send new commands\n        # WHY: Continuous command updates are necessary for smooth robot motion control\n        self.timer = self.create_timer(0.1, self.timer_callback)\n\n        # Counter for generating different command values\n        self.counter = 0\n\n        self.get_logger().info('Joint Command Publisher node initialized')\n\n    def timer_callback(self):\n        \"\"\"Publish joint position commands at regular intervals\"\"\"\n        # Create message to hold joint commands\n        # WHAT: This creates a Float64MultiArray message containing joint position commands\n        # WHY: The Float64MultiArray is a flexible message type for sending multiple numerical values\n        msg = Float64MultiArray()\n\n        # Generate a pattern of joint positions using sine waves\n        # WHAT: This generates smooth, oscillating joint position commands\n        # WHY: Using sine waves creates natural-looking motion patterns for demonstration\n        joint_positions = []\n        for i in range(6):  # Example: 6 joints\n            position = 0.5 * math.sin(self.counter * 0.1 + i * math.pi / 3)\n            joint_positions.append(position)\n\n        msg.data = joint_positions\n\n        # Publish the joint command message\n        # WHAT: This publishes the joint position commands to the 'joint_commands' topic\n        # WHY: Other nodes (like the robot controller) subscribe to this topic to receive commands\n        self.publisher.publish(msg)\n\n        # Log the published values for debugging\n        self.get_logger().info(f'Published joint commands: {msg.data}')\n\n        # Increment counter for next iteration\n        self.counter += 1\n\ndef main(args=None):\n    \"\"\"Main function to initialize and run the ROS 2 publisher node\"\"\"\n    # Initialize the ROS 2 client library\n    # WHAT: This initializes the rclpy library and prepares it for node creation\n    # WHY: All ROS 2 Python programs must initialize the client library before creating nodes\n    rclpy.init(args=args)\n\n    # Create an instance of the JointCommandPublisher node\n    # WHAT: This creates the publisher node instance\n    # WHY: The node contains all the logic for publishing joint commands\n    joint_publisher = JointCommandPublisher()\n\n    try:\n        # Start spinning the node to process callbacks\n        # WHAT: This starts the ROS 2 event loop, processing timer callbacks and other events\n        # WHY: Without spinning, the node wouldn't execute its timer callback to publish commands\n        rclpy.spin(joint_publisher)\n    except KeyboardInterrupt:\n        # Handle graceful shutdown when user interrupts the program\n        pass\n    finally:\n        # Clean up resources\n        # WHAT: This destroys the node and shuts down the rclpy library\n        # WHY: Proper cleanup is important to free resources and avoid potential issues\n        joint_publisher.destroy_node()\n        rclpy.shutdown()\n\nif __name__ == '__main__':\n    main()\n"})}),"\n",(0,s.jsx)(n.h2,{id:"dependencies",children:"Dependencies"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"rclpy"})," version Kilted Kaiju (2025)"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"std_msgs"})," - Standard ROS 2 message types"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.code,{children:"sensor_msgs"})," - Sensor-related message types"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"how-to-run",children:"How to Run"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-bash",children:"# Make sure your ROS 2 environment is sourced\nsource /opt/ros/kilted/setup.bash\n\n# Run the publisher node\npython3 joint_command_publisher.py\n"})}),"\n",(0,s.jsx)(n.h2,{id:"expected-output",children:"Expected Output"}),"\n",(0,s.jsx)(n.p,{children:"The publisher will continuously output joint position commands to the console every 0.1 seconds, with values oscillating in a sine wave pattern."})]})}function m(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(d,{...e})}):d(e)}},8453(e,n,t){t.d(n,{R:()=>r,x:()=>a});var o=t(6540);const s={},i=o.createContext(s);function r(e){const n=o.useContext(i);return o.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:r(e.components),o.createElement(i.Provider,{value:n},e.children)}}}]);